(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4859],{4177:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>i});var r=a(95155),s=a(12115),n=a(35695),o=a(6874),l=a.n(o),c=a(40283);function i(){let[e,t]=(0,s.useState)(""),[a,o]=(0,s.useState)(""),[i,u]=(0,s.useState)(""),[d,h]=(0,s.useState)(!1),{login:m}=(0,c.A)();(0,n.useRouter)();let g=async t=>{t.preventDefault(),u(""),h(!0);try{await m(e,a)}catch(e){u(e.message||"Đăng nhập thất bại")}finally{h(!1)}};return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-green-50 to-blue-50 px-4",children:(0,r.jsxs)("div",{className:"max-w-md w-full space-y-8 bg-white p-8 rounded-2xl shadow-xl",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-3xl font-bold text-gray-900",children:"Đăng nhập"}),(0,r.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"V\xe0o GreenEduMap để kh\xe1m ph\xe1 c\xe1c trường học xanh"})]}),i&&(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:(0,r.jsx)("p",{className:"text-sm",children:i})}),(0,r.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:g,children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),(0,r.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:e,onChange:e=>t(e.target.value),className:"appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"your@email.com"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Mật khẩu"}),(0,r.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:a,onChange:e=>o(e.target.value),className:"appearance-none relative block w-full px-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"••••••••"})]})]}),(0,r.jsx)("button",{type:"submit",disabled:d,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:d?"Đang đăng nhập...":"Đăng nhập"}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Chưa c\xf3 t\xe0i khoản?"," ",(0,r.jsx)(l(),{href:"/auth/register",className:"font-medium text-green-600 hover:text-green-500",children:"Đăng k\xfd ngay"})]})}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)(l(),{href:"/",className:"text-sm text-gray-500 hover:text-gray-700",children:"← Quay lại trang chủ"})})]})]})})}},35695:(e,t,a)=>{"use strict";var r=a(18999);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}})},40283:(e,t,a)=>{"use strict";a.d(t,{A:()=>i,O:()=>c});var r=a(95155),s=a(12115),n=a(35695);let o=(0,s.createContext)(void 0),l="http://localhost:8000";function c(e){let{children:t}=e,[a,c]=(0,s.useState)(null),[i,u]=(0,s.useState)(!0),d=(0,n.useRouter)();(0,s.useEffect)(()=>{let e=localStorage.getItem("accessToken");e?h(e):u(!1)},[]);let h=async e=>{try{let t=await fetch("".concat(l,"/api/v1/auth/me"),{headers:{Authorization:"Bearer ".concat(e)}});if(t.ok){let e=await t.json();c(e)}else localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken")}catch(e){console.error("Failed to fetch user:",e)}finally{u(!1)}},m=async(e,t)=>{let a=await fetch("".concat(l,"/api/v1/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(!a.ok)throw Error((await a.json()).detail||"Login failed");let r=await a.json();localStorage.setItem("accessToken",r.access_token),localStorage.setItem("refreshToken",r.refresh_token),await h(r.access_token),d.push("/")},g=async(e,t,a,r)=>{let s=await fetch("".concat(l,"/api/v1/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,email:t,password:a,full_name:r,role:"citizen"})});if(!s.ok)throw Error((await s.json()).detail||"Registration failed");await m(t,a)},p=async()=>{let e=localStorage.getItem("accessToken");e&&await h(e)};return(0,r.jsx)(o.Provider,{value:{user:a,isAuthenticated:!!a,isLoading:i,login:m,register:g,logout:()=>{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),c(null),d.push("/auth/login")},refreshUser:p},children:t})}function i(){let e=(0,s.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},48079:(e,t,a)=>{Promise.resolve().then(a.bind(a,4177))}},e=>{var t=t=>e(e.s=t);e.O(0,[6874,8441,1684,7358],()=>t(48079)),_N_E=e.O()}]);
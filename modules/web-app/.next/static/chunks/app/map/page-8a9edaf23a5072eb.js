(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5823],{18341:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>k});var s=a(95155),r=a(12115),i=a(64690),l=a(47924),n=a(54416),o=a(38274),c=a(19114);function d(e){let{onSearch:t,placeholder:a="T\xecm phường/x\xe3..."}=e,[i,d]=(0,r.useState)("");return(0,s.jsx)(o.P.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"absolute top-24 left-96 right-4 z-20",children:(0,s.jsx)("form",{onSubmit:e=>{e.preventDefault(),t(i)},className:"relative",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(l.A,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,s.jsx)("input",{type:"text",value:i,onChange:e=>d(e.target.value),placeholder:a,className:"w-full pl-12 pr-12 py-3 bg-white/95 dark:bg-gray-900/95 backdrop-blur-xl border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg focus:outline-none focus:ring-2 focus:ring-success-500 focus:border-transparent text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400"}),(0,s.jsx)(c.N,{children:i&&(0,s.jsx)(o.P.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},type:"button",onClick:()=>{d(""),t("")},className:"absolute right-3 top-1/2 transform -translate-y-1/2 p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:(0,s.jsx)(n.A,{className:"w-4 h-4 text-gray-400"})})})]})})})}var m=a(4516),g=a(7574),u=a(48691),h=a(44992),x=a(53896);function p(e){var t,a;let{ward:r,isOpen:i,onClose:l}=e;return r?(0,s.jsx)(c.N,{children:i&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:l,className:"fixed inset-0 bg-black/20 backdrop-blur-sm z-30"}),(0,s.jsx)(o.P.div,{initial:{x:400},animate:{x:0},exit:{x:400},transition:{type:"spring",damping:25,stiffness:200},className:"fixed right-0 top-0 bottom-0 w-96 bg-white dark:bg-gray-900 shadow-2xl z-40 overflow-y-auto",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Chi tiết khu vực"}),(0,s.jsx)("button",{onClick:l,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:(0,s.jsx)(n.A,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)(m.A,{className:"w-5 h-5 text-success-600"}),(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:r.ward_name})]}),r.district&&(0,s.jsxs)("p",{className:"text-gray-600 dark:text-gray-400 ml-7",children:[r.district,", ",r.city]})]}),(0,s.jsxs)("div",{className:"mb-6 p-6 rounded-xl border-2 ".concat((t=r.aqi)<=50?"text-green-600 bg-green-50 dark:bg-green-900/20":t<=100?"text-yellow-600 bg-yellow-50 dark:bg-yellow-900/20":t<=150?"text-orange-600 bg-orange-50 dark:bg-orange-900/20":t<=200?"text-red-600 bg-red-50 dark:bg-red-900/20":"text-purple-600 bg-purple-50 dark:bg-purple-900/20"),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm font-medium opacity-75 mb-1",children:"Chỉ số AQI"}),(0,s.jsx)("div",{className:"text-4xl font-bold",children:r.aqi.toFixed(1)})]}),(0,s.jsx)(g.A,{className:"w-12 h-12 opacity-50"})]}),(0,s.jsx)("div",{className:"text-sm font-medium",children:(a=r.aqi)<=50?"Tốt":a<=100?"Trung b\xecnh":a<=150?"Kh\xf4ng tốt cho nh\xf3m nhạy cảm":a<=200?"Kh\xf4ng tốt":"Rất kh\xf4ng tốt"})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wide mb-3",children:"Chỉ số chất lượng kh\xf4ng kh\xed"}),(0,s.jsxs)("div",{className:"space-y-3",children:[r.pm25&&(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800/50 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(u.A,{className:"w-4 h-4 text-blue-500"}),(0,s.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"PM2.5"})]}),(0,s.jsxs)("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:[r.pm25.toFixed(1)," μg/m\xb3"]})]}),r.pm10&&(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800/50 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(u.A,{className:"w-4 h-4 text-blue-600"}),(0,s.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"PM10"})]}),(0,s.jsxs)("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:[r.pm10.toFixed(1)," μg/m\xb3"]})]}),r.no2&&(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800/50 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(g.A,{className:"w-4 h-4 text-orange-500"}),(0,s.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"NO₂"})]}),(0,s.jsxs)("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:[r.no2.toFixed(1)," ppb"]})]}),r.o3&&(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800/50 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(h.A,{className:"w-4 h-4 text-red-500"}),(0,s.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"O₃"})]}),(0,s.jsxs)("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:[r.o3.toFixed(1)," ppb"]})]})]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wide mb-3",children:"Gi\xe1o dục"}),(0,s.jsxs)("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)(x.A,{className:"w-5 h-5 text-blue-600"}),(0,s.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:"Trường học trong khu vực"})]}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Dữ liệu đang được cập nhật..."})]})]}),r.latitude&&r.longitude&&(0,s.jsxs)("div",{className:"p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg",children:[(0,s.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Tọa độ"}),(0,s.jsxs)("div",{className:"text-sm font-mono text-gray-900 dark:text-white",children:[r.latitude.toFixed(6),", ",r.longitude.toFixed(6)]})]}),r.measurement_date&&(0,s.jsxs)("div",{className:"mt-4 text-xs text-gray-500 dark:text-gray-500",children:["Cập nhật: ",new Date(r.measurement_date).toLocaleString("vi-VN")]})]})})]})}):null}var y=a(49101),f=a.n(y);a(66467);var b=a(49509);let v=b.env.NEXT_PUBLIC_MAPTILER_API_KEY||"dpmkld1oGcbPpGtsRgKX",w="https://api.maptiler.com/maps/streets-v2/style.json?key=".concat(v),j=b.env.NEXT_PUBLIC_API_URL||"";function N(){let e=(0,r.useRef)(null),t=(0,r.useRef)(null),[a,l]=(0,r.useState)(!1),[n,o]=(0,r.useState)("aqi"),[c,m]=(0,r.useState)({trees:!0,schools:!0,solar:!0}),[g,u]=(0,r.useState)(null),[h,x]=(0,r.useState)(!1),[y,b]=(0,r.useState)(""),[v,N]=(0,r.useState)(null),[k,C]=(0,r.useState)(null),[S,_]=(0,r.useState)(null),[L,A]=(0,r.useState)(null),[q,P]=(0,r.useState)(null),[F,E]=(0,r.useState)([]),[I,T]=(0,r.useState)([]),[z,D]=(0,r.useState)([]),[O,M]=(0,r.useState)([]),[H,R]=(0,r.useState)([]);(0,r.useEffect)(()=>{(async()=>{try{let e=await fetch("".concat(j,"/api/v1/air-quality?limit=500"));if(e.ok){let t=await e.json();Array.isArray(t)&&t.length>0&&E(t.filter(e=>e.latitude&&e.longitude&&null!==e.aqi&&void 0!==e.aqi).map((e,t)=>{var a,s,r;return{id:null!==(a=e.id)&&void 0!==a?a:t,ward_name:e.station_name||"Điểm đo",district:e.district||"",city:e.city||"Ho Chi Minh City",latitude:e.latitude,longitude:e.longitude,aqi:Number(e.aqi),pm25:null!==(s=e.pm25)&&void 0!==s?s:void 0,pm10:null!==(r=e.pm10)&&void 0!==r?r:void 0}}))}else console.warn("Failed to fetch AQI data:",e.statusText);let t=await fetch("".concat(j,"/api/v1/weather?limit=500"));if(t.ok){let e=await t.json();Array.isArray(e)&&e.length>0&&T(e.filter(e=>e.latitude&&e.longitude&&null!==e.temperature&&void 0!==e.temperature).map((e,t)=>{var a;return{id:null!==(a=e.id)&&void 0!==a?a:t,ward_name:e.city_name||"Khu vực",district:e.district||"",city:e.city||"Ho Chi Minh City",latitude:e.latitude,longitude:e.longitude,temperature:Number(e.temperature)}}))}else console.warn("Failed to fetch weather data:",t.statusText)}catch(e){console.error("Error loading real-time AQI/Weather:",e)}})(),(async()=>{try{let e=await fetch("".concat(j,"/api/v1/schools?limit=500"));if(e.ok){let t=await e.json();if(Array.isArray(t)&&t.length>0){let e=t.filter(e=>e.latitude&&e.longitude);console.log("✅ Loaded ".concat(e.length," schools with location")),D(t),_({type:"FeatureCollection",features:e.map(e=>({type:"Feature",geometry:{type:"Point",coordinates:[e.longitude,e.latitude]},properties:{id:e.id,name:e.name,district:e.district||"",students:e.total_students||0}}))})}else console.warn("⚠️ No schools data or empty array")}else console.warn("Failed to fetch schools:",e.statusText)}catch(e){console.error("Error loading schools:",e)}})(),(async()=>{try{let e=await fetch("".concat(j,"/api/v1/green-zones?limit=500"));if(e.ok){let t=await e.json();if(Array.isArray(t)&&t.length>0){let e=t.filter(e=>e.latitude&&e.longitude);console.log("✅ Loaded ".concat(e.length," green zones with location")),M(t),A({type:"FeatureCollection",features:e.map(e=>({type:"Feature",geometry:{type:"Point",coordinates:[e.longitude,e.latitude]},properties:{id:e.id,name:e.name,district:e.address||"",count:e.tree_count||0}}))})}else console.warn("⚠️ No green zones data or empty array")}else console.warn("Failed to fetch green zones:",e.statusText)}catch(e){console.error("Error loading green zones:",e)}})(),(async()=>{try{let e=await fetch("".concat(j,"/api/v1/green-resources?limit=500"));if(e.ok){let t=await e.json();if(Array.isArray(t)&&t.length>0){R(t);let e=t.filter(e=>e.type&&(e.type.toLowerCase().includes("solar")||e.type.toLowerCase().includes("nlm")));if(e.length>0){[...new Set(e.map(e=>e.zone_id).filter(Boolean))];let t=new Map,a=await fetch("".concat(j,"/api/v1/green-zones?limit=500"));a.ok&&(await a.json()).forEach(e=>{t.set(e.id,e)});let s=e.map(e=>{let a=t.get(e.zone_id);return a&&a.latitude&&a.longitude?{type:"Feature",geometry:{type:"Point",coordinates:[a.longitude,a.latitude]},properties:{id:e.id,name:e.name||"Trạm NLMT ".concat(a.name),district:a.address||"",power:"".concat(e.quantity||0," ").concat(e.unit||"kW")}}:null}).filter(Boolean);P({type:"FeatureCollection",features:s})}}}else console.warn("Failed to fetch green resources:",e.statusText)}catch(e){console.error("Error loading green resources:",e)}})()},[]);let K={type:"FeatureCollection",features:F.map(e=>({type:"Feature",geometry:{type:"Point",coordinates:[e.longitude,e.latitude]},properties:{value:e.aqi,...e}}))},Q={type:"FeatureCollection",features:I.map(e=>({type:"Feature",geometry:{type:"Point",coordinates:[e.longitude,e.latitude]},properties:{value:e.temperature,...e}}))};return(0,r.useEffect)(()=>{if(!e.current||t.current)return;let a=new(f()).Map({container:e.current,style:w,center:[106.6297,10.8231],zoom:11,pitch:45,bearing:-17.6});return t.current=a,a.on("load",()=>{l(!0),a.addSource("aqi-heatmap",{type:"geojson",data:K}),a.addLayer({id:"aqi-heatmap",type:"heatmap",source:"aqi-heatmap",maxzoom:15,layout:{visibility:"visible"},paint:{"heatmap-weight":["interpolate",["linear"],["get","value"],0,0,50,.3,100,.6,150,.9,200,1],"heatmap-color":["interpolate",["linear"],["heatmap-density"],0,"rgba(34, 197, 94, 0)",.2,"rgba(34, 197, 94, 0.5)",.4,"rgba(234, 179, 8, 0.7)",.6,"rgba(249, 115, 22, 0.8)",.8,"rgba(239, 68, 68, 0.9)",1,"rgba(168, 85, 247, 1)"],"heatmap-radius":50,"heatmap-opacity":.8}}),a.addSource("temperature-heatmap",{type:"geojson",data:Q}),a.addLayer({id:"temperature-heatmap",type:"heatmap",source:"temperature-heatmap",maxzoom:15,layout:{visibility:"none"},paint:{"heatmap-weight":["interpolate",["linear"],["get","value"],0,0,25,.3,30,.7,35,1,40,1],"heatmap-color":["interpolate",["linear"],["heatmap-density"],0,"rgba(59, 130, 246, 0)",.4,"rgba(59, 130, 246, 0.6)",.6,"rgba(251, 191, 36, 0.8)",1,"rgba(239, 68, 68, 1)"],"heatmap-radius":50,"heatmap-opacity":.8}}),a.addLayer({id:"aqi-circles",type:"circle",source:"aqi-heatmap",paint:{"circle-radius":["interpolate",["linear"],["get","value"],0,5,200,30],"circle-color":["interpolate",["linear"],["get","value"],0,"#22c55e",50,"#22c55e",100,"#eab308",150,"#f97316",200,"#ef4444",300,"#a855f7"],"circle-opacity":0,"circle-stroke-width":0}}),a.on("click","aqi-circles",e=>{var t;let a=null===(t=e.features)||void 0===t?void 0:t[0];if(!a)return;let s=a.properties;u({id:s.id,ward_name:s.ward_name,district:s.district,city:s.city||"Ho Chi Minh City",latitude:s.latitude,longitude:s.longitude,aqi:s.aqi,pm25:s.pm25,pm10:s.pm10,measurement_date:new Date().toISOString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()}),x(!0)}),a.on("mouseenter","aqi-circles",()=>{a.getCanvas().style.cursor="pointer"}),a.on("mouseleave","aqi-circles",()=>{a.getCanvas().style.cursor=""}),a.on("mousemove","aqi-circles",e=>{var t;let a=null===(t=e.features)||void 0===t?void 0:t[0];if(!a)return;let s=a.properties;N({id:s.id,ward_name:s.ward_name,district:s.district,city:s.city||"Ho Chi Minh City",latitude:s.latitude,longitude:s.longitude,aqi:s.aqi,pm25:s.pm25,pm10:s.pm10,measurement_date:new Date().toISOString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()})})}),()=>{t.current&&(t.current.remove(),t.current=null)}},[]),(0,r.useEffect)(()=>{var e,s,r;let i=t.current;if(!i||!a){console.log("⏳ Waiting for map to load...",{map:!!i,isMapLoaded:a,schoolData:!!S,treeData:!!L,solarData:!!q});return}if(!S||!L||!q){console.log("⏳ Waiting for data...",{schoolData:!!S,treeData:!!L,solarData:!!q});return}console.log("✅ Adding icon layers to map...",{schools:(null===(e=S.features)||void 0===e?void 0:e.length)||0,trees:(null===(s=L.features)||void 0===s?void 0:s.length)||0,solar:(null===(r=q.features)||void 0===r?void 0:r.length)||0});let l=(e,t,a,s)=>{i.getLayer("".concat(e,"-layer"))&&i.removeLayer("".concat(e,"-layer")),i.getSource(e)&&i.removeSource(e),i.addSource(e,{type:"geojson",data:a}),(async()=>{try{let a=await new Promise((e,a)=>{let s=new Image;s.crossOrigin="anonymous",s.onload=()=>e(s),s.onerror=a,s.src=t});i.hasImage("".concat(e,"-icon"))||i.addImage("".concat(e,"-icon"),a),i.addLayer({id:"".concat(e,"-layer"),type:"symbol",source:e,layout:{"icon-image":"".concat(e,"-icon"),"icon-size":.08,"icon-allow-overlap":!0,"text-field":["get","name"],"text-offset":[0,1.5],"text-size":11,"text-anchor":"top","text-optional":!0,visibility:c[e]?"visible":"none"},paint:{"text-color":"schools"===e?"#7c3aed":"trees"===e?"#16a34a":"#d97706","text-halo-color":"#fff","text-halo-width":1}})}catch(t){console.error("Error loading ".concat(e," icon:"),t),i.addLayer({id:"".concat(e,"-layer"),type:"circle",source:e,paint:{"circle-radius":8,"circle-color":"schools"===e?"#a855f7":"trees"===e?"#22c55e":"#f59e0b","circle-stroke-width":2,"circle-stroke-color":"#fff"},layout:{visibility:c[e]?"visible":"none"}})}})()};l("schools","/images/education.png",S,"Trường học"),l("trees","/images/tree.png",L,"C\xe2y xanh"),l("solar","/images/sun.png",q,"Năng lượng mặt trời"),["schools-layer","trees-layer","solar-layer"].forEach(e=>{i.on("click",e,t=>{var a;let s=null===(a=t.features)||void 0===a?void 0:a[0];if(!s)return;let r=s.properties,l=s.geometry.coordinates;new(f()).Popup().setLngLat(l).setHTML("<strong>".concat(r.name,"</strong><br/>").concat(r.district||"")).addTo(i);let n=e.replace("-layer",""),o="";"schools"===n?o="Số học sinh: ".concat(r.students||"N/A"):"trees"===n?o="Số c\xe2y: ".concat(r.count||"N/A"):"solar"===n&&(o="C\xf4ng suất: ".concat(r.power||"N/A")),C({title:r.name,content:o,type:n}),r.ward_name&&(u({id:r.id,ward_name:r.ward_name,district:r.district,city:r.city||"Ho Chi Minh City",latitude:r.latitude,longitude:r.longitude,aqi:r.aqi,pm25:r.pm25,pm10:r.pm10,measurement_date:new Date().toISOString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()}),x(!0))}),i.on("mouseenter",e,()=>{i.getCanvas().style.cursor="pointer"}),i.on("mouseleave",e,()=>{i.getCanvas().style.cursor=""})})},[S,L,q,a,c]),(0,r.useEffect)(()=>{let e=t.current;e&&a&&(e.setLayoutProperty("aqi-heatmap","visibility","aqi"===n?"visible":"none"),e.setLayoutProperty("temperature-heatmap","visibility","temperature"===n?"visible":"none"))},[n,a]),(0,r.useEffect)(()=>{let e=t.current;e&&a&&["schools-layer","trees-layer","solar-layer"].forEach(t=>{if(e.getLayer(t)){let a=t.replace("-layer","");e.setLayoutProperty(t,"visibility",c[a]?"visible":"none")}})},[c,a]),(0,s.jsxs)("div",{className:"relative w-full h-screen overflow-hidden",children:[(0,s.jsx)(i.A,{}),(0,s.jsxs)("div",{className:"absolute inset-0 pt-20 sm:pt-24",children:[(0,s.jsx)("div",{ref:e,className:"w-full h-full"}),v&&(0,s.jsxs)("div",{className:"absolute top-28 left-96 p-3 bg-white/95 dark:bg-gray-900/95 backdrop-blur-xl rounded-lg shadow-xl z-20 max-w-xs",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white mb-1",children:v.ward_name}),(0,s.jsxs)("div",{className:"text-sm space-y-1",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"AQI:"}),(0,s.jsx)("span",{className:"font-semibold text-gray-900 dark:text-white",children:v.aqi.toFixed(1)})]}),v.district&&(0,s.jsx)("div",{className:"text-gray-600 dark:text-gray-400",children:v.district})]})]}),(0,s.jsx)("div",{className:"absolute left-0 top-20 sm:top-24 bottom-0 w-80 bg-white/95 dark:bg-gray-900/95 backdrop-blur-xl shadow-2xl z-10 overflow-y-auto",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:"Lớp dữ liệu"}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wide mb-3",children:"Heatmap"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("label",{className:"flex items-center gap-3 p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50 hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer transition-colors",children:[(0,s.jsx)("input",{type:"radio",name:"heatmap",checked:"aqi"===n,onChange:()=>o("aqi"),className:"w-4 h-4 text-success-600 focus:ring-success-500"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"AQI (Chất lượng kh\xf4ng kh\xed)"})]}),(0,s.jsxs)("label",{className:"flex items-center gap-3 p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50 hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer transition-colors",children:[(0,s.jsx)("input",{type:"radio",name:"heatmap",checked:"temperature"===n,onChange:()=>o("temperature"),className:"w-4 h-4 text-success-600 focus:ring-success-500"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Nhiệt độ"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wide mb-3",children:"Icon Layers"}),(0,s.jsx)("div",{className:"space-y-2",children:[{key:"trees",label:"C\xe2y xanh"},{key:"schools",label:"Trường học"},{key:"solar",label:"Năng lượng mặt trời"}].map(e=>(0,s.jsxs)("label",{className:"flex items-center gap-3 p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50 hover:bg-gray-100 dark:hover:bg-gray-800 cursor-pointer transition-colors",children:[(0,s.jsx)("input",{type:"checkbox",checked:c[e.key],onChange:()=>m({...c,[e.key]:!c[e.key]}),className:"w-5 h-5 text-success-600 rounded focus:ring-success-500 focus:ring-2"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.label})]},e.key))})]}),(0,s.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg",children:[(0,s.jsxs)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:["Thang m\xe0u ","aqi"===n?"AQI":"Nhiệt độ"]}),(0,s.jsx)("div",{className:"h-3 w-full rounded-full mb-2",style:{background:"aqi"===n?"linear-gradient(90deg, #22c55e, #eab308, #f97316, #ef4444, #a855f7)":"linear-gradient(90deg, #3b82f6, #fbbf24, #ef4444)"}}),(0,s.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1",children:"aqi"===n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded bg-green-500"}),(0,s.jsx)("span",{children:"Tốt (0-50)"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded bg-yellow-500"}),(0,s.jsx)("span",{children:"Trung b\xecnh (51-100)"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded bg-orange-500"}),(0,s.jsx)("span",{children:"Kh\xf4ng tốt (101-150)"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded bg-red-500"}),(0,s.jsx)("span",{children:"\xd4 nhiễm (151-200)"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded bg-purple-500"}),(0,s.jsx)("span",{children:"Rất \xf4 nhiễm (>200)"})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded bg-blue-500"}),(0,s.jsx)("span",{children:"M\xe1t (25-28\xb0C)"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded bg-yellow-500"}),(0,s.jsx)("span",{children:"Ấm (29-32\xb0C)"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded bg-red-500"}),(0,s.jsx)("span",{children:"N\xf3ng (>32\xb0C)"})]})]})})]})]})}),(0,s.jsx)(d,{onSearch:e=>{b(e);let a=t.current;if(!a||!e.trim())return;let s=e.toLowerCase(),r=F.find(e=>{var t,a;return(null===(t=e.ward_name)||void 0===t?void 0:t.toLowerCase().includes(s))||(null===(a=e.district)||void 0===a?void 0:a.toLowerCase().includes(s))})||z.find(e=>{var t,a;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(s))||(null===(a=e.district)||void 0===a?void 0:a.toLowerCase().includes(s))})||O.find(e=>{var t,a;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(s))||(null===(a=e.address)||void 0===a?void 0:a.toLowerCase().includes(s))})||H.find(e=>{var t;return null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(s)});if(r&&a){let e=r.latitude,t=r.longitude;e&&t&&a.flyTo({center:[t,e],zoom:14,duration:1500})}}}),(0,s.jsx)(p,{ward:g,isOpen:h,onClose:()=>{x(!1),C(null)}}),k&&!h&&(0,s.jsx)("div",{className:"absolute top-20 sm:top-24 right-0 bottom-0 w-80 bg-white dark:bg-gray-900 shadow-2xl z-40 overflow-y-auto",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:k.title}),(0,s.jsx)("button",{onClick:()=>C(null),className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-600 dark:text-gray-400","aria-label":"Đ\xf3ng",children:"\xd7"})]}),(0,s.jsx)("div",{className:"p-4 bg-success-50 dark:bg-success-900/20 rounded-lg",children:(0,s.jsx)("p",{className:"text-gray-900 dark:text-white",children:k.content})})]})})]})]})}function k(){return(0,s.jsx)(r.Suspense,{fallback:(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)("div",{className:"text-gray-600 dark:text-gray-400",children:"Đang tải bản đồ..."})}),children:(0,s.jsx)(N,{})})}},64690:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var s=a(95155),r=a(6874),i=a.n(r),l=a(12115),n=a(38274),o=a(35695);function c(){let[e,t]=(0,l.useState)(!1),a=(0,o.usePathname)();return(0,l.useEffect)(()=>{let e=()=>{t(window.scrollY>20)};return window.addEventListener("scroll",e),()=>{window.removeEventListener("scroll",e)}},[]),(0,s.jsx)(n.P.nav,{initial:{y:-100},animate:{y:0},className:"fixed top-0 left-0 right-0 z-50 transition-all duration-500 ".concat(e||"/"!==a?"bg-white/80 dark:bg-gray-950/80 backdrop-blur-xl shadow-theme-lg border-b border-gray-200/50 dark:border-gray-800/50":"bg-transparent"),children:(0,s.jsx)("div",{className:"px-4 mx-auto max-w-7xl sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex items-center justify-between h-16 sm:h-20",children:[(0,s.jsx)(i(),{href:"/",className:"flex items-center gap-2",children:(0,s.jsx)(n.P.div,{whileHover:{scale:1.05},children:(0,s.jsx)("img",{src:"/images/logo/logo.svg",alt:"GreenEduMap Logo",className:"h-8 w-auto"})})}),(0,s.jsx)("div",{className:"hidden gap-8 md:flex",children:[{name:"Bản đồ",href:"/map"},{name:"H\xe0nh động xanh",href:"/actions"},{name:"Thống k\xea",href:"/stats"}].map((e,t)=>(0,s.jsxs)(n.P.a,{href:e.href,className:"text-sm font-medium transition-colors relative group ".concat(a===e.href?"text-success-600 dark:text-success-400":"text-gray-700 hover:text-success-600 dark:text-gray-300 dark:hover:text-success-400"),initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.1*t},children:[e.name,(0,s.jsx)("span",{className:"absolute bottom-0 left-0 h-0.5 bg-gradient-to-r from-success-500 to-success-600 transition-all ".concat(a===e.href?"w-full":"w-0 group-hover:w-full")})]},e.name))}),(0,s.jsxs)(n.P.div,{className:"flex items-center gap-3",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.3},children:[(0,s.jsx)(i(),{href:"/login",className:"px-4 py-2 text-sm font-medium text-gray-700 transition-all rounded-lg hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-800/50",children:"Đăng nhập"}),(0,s.jsx)(i(),{href:"/register",className:"px-4 py-2 text-sm font-medium text-white transition-all rounded-lg bg-gradient-to-r from-success-500 to-success-600 hover:shadow-lg hover:shadow-success-500/50 hover:scale-105",children:"Đăng k\xfd"})]})]})})})}},69336:(e,t,a)=>{Promise.resolve().then(a.bind(a,18341))}},e=>{var t=t=>e(e.s=t);e.O(0,[4466,5600,6874,8274,2558,8441,1684,7358],()=>t(69336)),_N_E=e.O()}]);